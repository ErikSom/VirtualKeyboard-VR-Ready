!function(a,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((a=a||self).VRKeyboard={})}(this,(function(a){"use strict";const r=["en","fr","es","ru"],t={en:[[{char:"q",extra:[{char:"1"}],alt:"1"},{char:"w",extra:[{char:"2"}],alt:"2"},{char:"e",extra:[{char:"è"},{char:"3"},{char:"é"},{char:"ê"},{char:"ę"},{char:"ë"},{char:"ē"},{char:"ė"}],alt:"3"},{char:"r",extra:[{char:"4"}],alt:"4"},{char:"t",extra:[{char:"5"}],alt:"5"},{char:"y",extra:[{char:"ý"},{char:"6"},{char:"ĳ"},{char:"ÿ"}],alt:"6"},{char:"u",extra:[{char:"û"},{char:"7"},{char:"ú"},{char:"ū"},{char:"ü"},{char:"ù"}],alt:"7"},{char:"i",extra:[{char:"î"},{char:"8"},{char:"í"},{char:"ï"},{char:"į"},{char:"ī"},{char:"ì"},{char:"ĳ"}],alt:"8"},{char:"o",extra:[{char:"ò"},{char:"ö"},{char:"ô"},{char:"9"},{char:"ó"},{char:"õ"},{char:"ō"},{char:"œ"},{char:"ø"}],alt:"9"},{char:"p",extra:[{char:"0"}],alt:"0"}],[{char:"a",extra:[{char:"à"},{char:"á"},{char:"â"},{char:"ä"},{char:"æ"},{char:"ã"},{char:"å"},{char:"ā"},{char:"ª"}]},{char:"s",extra:[{char:"ß"}]},{char:"d"},{char:"f"},{char:"g"},{char:"h"},{char:"j",extra:[{char:"j́"}]},{char:"k"},{char:"l"}],[{char:"shift",w:1.5},{char:"z"},{char:"x"},{char:"c",extra:[{char:"ç"}]},{char:"v"},{char:"b"},{char:"n",extra:[{char:"ñ"},{char:"ń"}]},{char:"m"},{char:"bksp",w:1.5}],[{char:"?123",w:2},{char:","},{char:"lang"},{char:"space",w:3},{char:"."},{char:"enter",w:2}]],fr:[[{char:"a",extra:[{char:"à"},{char:"á"},{char:"1"},{char:"â"},{char:"ä"},{char:"æ"},{char:"ã"},{char:"å"},{char:"ā"},{char:"ª"}],alt:"1"},{char:"z",extra:[{char:"2"}],alt:"2"},{char:"e",extra:[{char:"è"},{char:"3"},{char:"é"},{char:"ê"},{char:"ę"},{char:"ë"},{char:"ē"},{char:"ė"}],alt:"3"},{char:"r",extra:[{char:"4"}],alt:"4"},{char:"t",extra:[{char:"5"}],alt:"5"},{char:"y",extra:[{char:"ý"},{char:"6"},{char:"ĳ"},{char:"ÿ"}],alt:"6"},{char:"u",extra:[{char:"û"},{char:"7"},{char:"ú"},{char:"ū"},{char:"ü"},{char:"ù"}],alt:"7"},{char:"i",extra:[{char:"î"},{char:"8"},{char:"í"},{char:"ï"},{char:"į"},{char:"ī"},{char:"ì"},{char:"ĳ"}],alt:"8"},{char:"o",extra:[{char:"ò"},{char:"ö"},{char:"ô"},{char:"9"},{char:"ó"},{char:"õ"},{char:"ō"},{char:"œ"},{char:"ø"}],alt:"9"},{char:"p",extra:[{char:"0"}],alt:"0"}],[{char:"q"},{char:"s",extra:[{char:"ß"}]},{char:"d"},{char:"f"},{char:"g"},{char:"h"},{char:"j",extra:[{char:"j́"}]},{char:"k"},{char:"l"},{char:"m"}],[{char:"shift",w:1.5},{char:"w"},{char:"x"},{char:"c",extra:[{char:"ç"}]},{char:"v"},{char:"b"},{char:"n",extra:[{char:"ñ"},{char:"ń"}]},{char:"'",extra:[{char:"‚"},{char:"‘"},{char:"’"},{char:"‹"},{char:"›"}]},{char:"bksp",w:1.5}],[{char:"?123",w:2},{char:","},{char:"lang"},{char:"space",w:3},{char:"."},{char:"enter",w:2}]],es:[[{char:"q",extra:[{char:"1"}],alt:"1"},{char:"w",extra:[{char:"2"}],alt:"2"},{char:"e",extra:[{char:"è"},{char:"3"},{char:"é"},{char:"ê"},{char:"ę"},{char:"ë"},{char:"ē"},{char:"ė"}],alt:"3"},{char:"r",extra:[{char:"4"}],alt:"4"},{char:"t",extra:[{char:"5"}],alt:"5"},{char:"y",extra:[{char:"ý"},{char:"6"},{char:"ĳ"},{char:"ÿ"}],alt:"6"},{char:"u",extra:[{char:"û"},{char:"7"},{char:"ú"},{char:"ū"},{char:"ü"},{char:"ù"}],alt:"7"},{char:"i",extra:[{char:"î"},{char:"8"},{char:"í"},{char:"ï"},{char:"į"},{char:"ī"},{char:"ì"},{char:"ĳ"}],alt:"8"},{char:"o",extra:[{char:"ò"},{char:"ö"},{char:"ô"},{char:"9"},{char:"ó"},{char:"õ"},{char:"ō"},{char:"œ"},{char:"ø"}],alt:"9"},{char:"p",extra:[{char:"0"}],alt:"0"}],[{char:"a",extra:[{char:"à"},{char:"á"},{char:"â"},{char:"ä"},{char:"æ"},{char:"ã"},{char:"å"},{char:"ā"},{char:"ª"}]},{char:"s",extra:[{char:"ß"}]},{char:"d"},{char:"f"},{char:"g"},{char:"h"},{char:"j",extra:[{char:"j́"}]},{char:"k"},{char:"l"},{char:"ñ"}],[{char:"shift",w:1.5},{char:"z"},{char:"x"},{char:"c",extra:[{char:"ç"}]},{char:"v"},{char:"b"},{char:"n",extra:[{char:"ñ"},{char:"ń"}]},{char:"m"},{char:"bksp",w:1.5}],[{char:"?123",w:2},{char:","},{char:"lang"},{char:"space",w:3},{char:"."},{char:"enter",w:2}]],ru:[[{char:"й",extra:[{char:"1"}],alt:"1"},{char:"ц",extra:[{char:"2"}],alt:"2"},{char:"у",extra:[{char:"3"},{char:"у́"}],alt:"3"},{char:"к",extra:[{char:"4"}],alt:"4"},{char:"е",extra:[{char:"е́"},{char:"5"},{char:"ё"}],alt:"5"},{char:"н",extra:[{char:"6"}],alt:"6"},{char:"г",extra:[{char:"7"},{char:"ґ"}],alt:"7"},{char:"ш",extra:[{char:"8"}],alt:"8"},{char:"щ",extra:[{char:"9"}],alt:"9"},{char:"з",extra:[{char:"0"}],alt:"0"},{char:"х"}],[{char:"ф"},{char:"ы",extra:[{char:"ы́"}]},{char:"в"},{char:"а",extra:[{char:"а́"}]},{char:"п"},{char:"р"},{char:"о",extra:[{char:"о́"}]},{char:"л"},{char:"д"},{char:"ж"},{char:"э",extra:[{char:"є"},{char:"э́"}]}],[{char:"shift"},{char:"я",extra:[{char:"я́"}]},{char:"ч"},{char:"с"},{char:"м"},{char:"и",extra:[{char:"ї"},{char:"и́"},{char:"і"}]},{char:"т"},{char:"ь",extra:[{char:"ъ"}]},{char:"б"},{char:"ю",extra:[{char:"ю́"}]},{char:"bksp"}],[{char:"?123",w:2},{char:","},{char:"lang"},{char:"space",w:4},{char:"."},{char:"enter",w:2}]],num:[[{char:"1",extra:[{char:"¹"},{char:"½"},{char:"⅓"},{char:"¼"},{char:"⅕"},{char:"⅙"},{char:"⅐"},{char:"⅛"},{char:"⅑"},{char:"⅒"}]},{char:"2",extra:[{char:"⅖"},{char:"²"},{char:"⅔"}]},{char:"3",extra:[{char:"⅗"},{char:"³"},{char:"¾"},{char:"⅜"}]},{char:"4",extra:[{char:"⁴"},{char:"⅘"}]},{char:"5",extra:[{char:"⅝"},{char:"⁵"},{char:"⅚"}]},{char:"6",extra:[{char:"⁶"}]},{char:"7",extra:[{char:"⁷"},{char:"⅞"}]},{char:"8",extra:[{char:"⁸"}]},{char:"9",extra:[{char:"⁹"}]},{char:"0",extra:[{char:"∅"},{char:"ⁿ"},{char:"⁰"}]}],[{char:"@"},{char:"#",extra:[{char:"№"}]},{char:"$",extra:[{char:"₱"},{char:"€"},{char:"¢"},{char:"£"},{char:"¥"}]},{char:"_"},{char:"&"},{char:"-",extra:[{char:"—"},{char:"_"},{char:"–"},{char:"·"}]},{char:"+",extra:[{char:"±"}]},{char:"(",extra:[{char:"["},{char:"<"},{char:"{"}]},{char:")",extra:[{char:"]"},{char:">"},{char:"}"}]},{char:"/"}],[{char:"=\\<",w:1.5},{char:"*",extra:[{char:"★"},{char:"†"},{char:"‡"}]},{char:'"',extra:[{char:"„"},{char:"“"},{char:"”"},{char:"«"},{char:"»"}]},{char:"'",extra:[{char:"‚"},{char:"‘"},{char:"’"},{char:"‹"},{char:"›"}]},{char:":"},{char:";"},{char:"!",extra:[{char:"¡"}]},{char:"?",extra:[{char:"¿"},{char:"‽"}]},{char:"bksp",w:1.5}],[{char:"abc",w:1.5},{char:","},{char:"1234"},{char:"space",w:4},{char:"."},{char:"enter",w:1.5}]],nump:[[{char:"+",extra:[{char:"-"}]},{char:"1",w:2},{char:"2",w:2},{char:"3",w:2},{char:"%"}],[{char:"*"},{char:"4",w:2},{char:"5",w:2},{char:"6",w:2},{char:"space"}],[{char:"/"},{char:"7",w:2},{char:"8",w:2},{char:"9",w:2},{char:"bksp"}],[{char:"abc"},{char:","},{char:"!?#"},{char:"0",w:2},{char:"="},{char:"."},{char:"enter"}]],sym:[[{char:"〜"},{char:"`"},{char:"|"},{char:"•",extra:[{char:"♣"},{char:"♠"},{char:"♪"},{char:"♥"},{char:"♦"}]},{char:"√"},{char:"π",extra:[{char:"Ω"},{char:"Π"},{char:"μ"}]},{char:"÷"},{char:"×"},{char:"¶",extra:["§"]},{char:"Δ"}],[{char:"£"},{char:"€"},{char:"$",extra:[{char:"₱"},{char:"€"},{char:"¢"},{char:"£"},{char:"¥"}]},{char:"¢"},{char:"^",extra:[{char:"←"},{char:"↑"},{char:"↓"},{char:"→"}]},{char:"°",extra:[{char:"′"},{char:"″"}]},{char:"=",extra:[{char:"∞"},{char:"≠"},{char:"≈"}]},{char:"{",extra:[{char:"("}]},{char:"}",extra:[{char:")"}]},{char:"\\"}],[{char:"?123",w:1.5},{char:"%",extra:[{char:"‰"},{char:"℅"}]},{char:"©"},{char:"®"},{char:"™"},{char:"✓"},{char:"["},{char:"]"},{char:"bksp",w:1.5}],[{char:"abc",w:1.5},{char:"<"},{char:"space",w:5},{char:">"},{char:"enter",w:1.5}]]};r.forEach(a=>{const c=t[a][3][2];c.extra=[],r.forEach(a=>{c.extra.push({char:a.toUpperCase()})})});const c={resolution:1,aspect:1.25,margin:5,fontSize:16,buttonHeight:40,buttonRadius:5,language:"en",font:"sans-serif",align:"center",swipe:!0,colors:{idle:"#3f4a52",hover:"#2d343a",down:"#5cb0a7",text:"#ffffff"},keyShadow:{shadowColor:"rgba(0, 0, 0, .3)",shadowBlur:1,shadowOffsetX:1,shadowOffsetY:1},popupShadow:{shadowColor:"rgba(0, 0, 0, .3)",shadowBlur:4,shadowOffsetX:0,shadowOffsetY:2},holdPopupTime:300,bkspIntervalTime:50},h=document.createElement("canvas"),e=h.getContext("2d"),n={bksp:"5MTEuMyA2ODMuNSI+PHBhdGggZD0iTTgzNS40IDBIMjY1LjhjLTI2LjIgMC00Ni43IDEzLjMtNjAuNCAzMy40TDAgMzQxLjhsMjA1LjQgMzA4YzEzLjcgMjAuMSAzNC4yIDMzLjggNjAuNCAzMy44aDU2OS42YzQxLjggMCA3NS45LTM0LjIgNzUuOS03NS45Vjc1LjljMC00MS43LTM0LjEtNzUuOS03NS45LTc1Ljl6bTAgNjA3LjZIMjY4LjVMOTEuMSAzNDEuOCAyNjguMSA3Nmg1NjcuM3Y1MzEuNnptLTQ0MC4xLTc2bDEzNi4zLTEzNi4zIDEzNi4zIDEzNi4zIDUzLjUtNTMuNS0xMzYuMi0xMzYuMyAxMzYuMy0xMzYuM0w2NjggMTUyIDUzMS42IDI4OC4yIDM5NS4zIDE1MS45bC01My41IDUzLjUgMTM2LjMgMTM2LjMtMTM2LjMgMTM2LjQgNTMuNSA1My41eiIvPjwvc3ZnPg==",shift:"5MTEuMyA2ODcuNSI+PHBhdGggZD0iTTQ1NS42IDY4Ny41Yy0zMy43IDAtNjUuNC0uMi04OS40LS41LTQ1LjItLjYtNDguMi0xLjQtNTIuOC0yLjgtMTcuMy00LjktMzIuMS0xNy45LTM5LjYtMzQuN2wtNS44LTEyLjgtLjMtMTMwLjctLjItOTFoLTM4LjRjLTQxLjYgMC02MC42IDAtNzIuNC0xLjEtMTQtMS4zLTI5LjYtNS4xLTM5LjQtMjQuMS01LjktMTEuMy05LjUtMjkuNCA3LTUxLjJsLjEtLjJjNi4xLTggMTEzLjEtMTI3LjcgMTQ1LjctMTY0LjIgMzYuNS00MC44IDcwLjYtNzguOSA5Ni4yLTEwNy40QzQxMiAxNS45IDQxMi42IDE1LjQgNDE1LjggMTNsLjUtLjRjNS44LTQuMyAxMy4zLTcuOCAxOC05LjVsLjUtLjJjMTYuOS01LjcgMzcuMi0zLjYgNTMuMSA1LjRsLjEuMWM5LjIgNS4zIDExLjEgNi4zIDE1Ny4xIDE2OS44IDU1LjIgNjEuNyA4OS42IDEwMC41IDExMS44IDEyNS44IDM1LjQgNDAuNCAzNi42IDQyLjkgMzkgNDkuMyA4LjggMjIuOC0uNSA0Ni0yMi44IDU2LjRsLS45LjRjLTExLjUgNC45LTE3LjQgNC45LTg5LjMgNC45SDY0NGwtLjIgOTEtLjQgMTMwLjctNS43IDEyLjdjLTcuNCAxNi44LTIyLjMgMjkuOC0zOS43IDM0LjgtNS4yIDEuNS0xMiAzLjMtMTQyLjQgMy4zek01NzcuOCA2MjNzMCAuMSAwIDB6bS0yNDQuMy0yLjFjMzcuOSAxLjYgMjA2LjYgMS42IDI0NC41IDBsLjMtMTE1IC4zLTE1Ni4yaDEzMWMtMjcuNC0zMS4zLTcxLTgwLjEtMTEzLjUtMTI3LjdDNTE2LjMgMTMyLjggNDY4LjggNzkuOSA0NTUgNjYuMiA0MjcuNiA5NiAyNjUuNSAyNzcuNCAyMDEuNCAzNDkuN2gxMzEuM0wzMzMgNTA2bC41IDExNC45eiIvPjwvc3ZnPg==",shift_perm:"5MTEuMyA4MzMuNCI+PHBhdGggZD0iTTQ1NS41IDY4Ny44Yy0zMy43IDAtNjUuNC0uMi04OS40LS41LTQ1LjItLjYtNDguMi0xLjQtNTIuOC0yLjgtMTcuMy00LjktMzIuMS0xNy45LTM5LjYtMzQuN0wyNjggNjM3bC0uNC0xMzAuNy0uMi05MUgyMjljLTQxLjYgMC02MC42IDAtNzIuNC0xLjEtMTQtMS4zLTI5LjYtNS4xLTM5LjQtMjQuMS01LjktMTEuMy05LjUtMjkuNCA3LTUxLjJsLjEtLjJjNi4xLTggMTEzLjEtMTI3LjcgMTQ1LjctMTY0LjIgMzYuNS00MC44IDcwLjYtNzguOSA5Ni4yLTEwNy40IDQ1LjctNTAuOSA0Ni40LTUxLjQgNDkuNS01My44bC41LS40YzUuOC00LjMgMTMuMy03LjggMTgtOS41bC41LS4yYzE2LjktNS43IDM3LjItMy42IDUzLjEgNS40bC4xLjFDNDk3LjEgMTQgNDk5IDE1IDY0NSAxNzguNWM1NS4yIDYxLjcgODkuNiAxMDAuNSAxMTEuOCAxMjUuOCAzNS40IDQwLjQgMzYuNiA0Mi45IDM5IDQ5LjMgOC44IDIyLjgtLjUgNDYtMjIuOCA1Ni40bC0uOS40Yy0xMS41IDQuOS0xNy40IDQuOS04OS4zIDQuOUg2NDRsLS4yIDkxLS41IDEzMC43LTUuNyAxMi43Yy03LjQgMTYuOC0yMi4zIDI5LjgtMzkuNyAzNC44LTUuMiAxLjUtMTIgMy4zLTE0Mi40IDMuM3ptMTIyLjItNjQuNXMwIC4xIDAgMHoiLz48cGF0aCBkPSJNMzAzLjggNzk3LjRoMzA0IiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iNzIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIi8+PC9zdmc+",shift_down:"5MTEuMyA2ODcuNSI+PHBhdGggZD0iTTQ1NS42IDY4Ny41Yy0zMy43IDAtNjUuNC0uMi04OS40LS41LTQ1LjItLjYtNDguMi0xLjQtNTIuOC0yLjgtMTcuMy00LjktMzIuMS0xNy45LTM5LjYtMzQuN2wtNS44LTEyLjgtLjMtMTMwLjctLjItOTFoLTM4LjRjLTQxLjYgMC02MC42IDAtNzIuNC0xLjEtMTQtMS4zLTI5LjYtNS4xLTM5LjQtMjQuMS01LjktMTEuMy05LjUtMjkuNCA3LTUxLjJsLjEtLjJjNi4xLTggMTEzLjEtMTI3LjcgMTQ1LjctMTY0LjIgMzYuNS00MC44IDcwLjYtNzguOSA5Ni4yLTEwNy40QzQxMiAxNS45IDQxMi42IDE1LjQgNDE1LjggMTNsLjUtLjRjNS44LTQuMyAxMy4zLTcuOCAxOC05LjVsLjUtLjJjMTYuOS01LjcgMzcuMi0zLjYgNTMuMSA1LjRsLjEuMWM5LjIgNS4zIDExLjEgNi4zIDE1Ny4xIDE2OS44IDU1LjIgNjEuNyA4OS42IDEwMC41IDExMS44IDEyNS44IDM1LjQgNDAuNCAzNi42IDQyLjkgMzkgNDkuMyA4LjggMjIuOC0uNSA0Ni0yMi44IDU2LjRsLS45LjRjLTExLjUgNC45LTE3LjQgNC45LTg5LjMgNC45SDY0NGwtLjIgOTEtLjQgMTMwLjctNS43IDEyLjdjLTcuNCAxNi44LTIyLjMgMjkuOC0zOS43IDM0LjgtNS4yIDEuNS0xMiAzLjMtMTQyLjQgMy4zek01NzcuOCA2MjNzMCAuMSAwIDB6Ii8+PC9zdmc+",enter:"xMDAwIDY4Ny41Ij48cGF0aCBkPSJNODgxLjIgMHYzMzIuNUgzNDUuOVY5NS43TC0uMyAzOTEuN2wzNDYuMiAyOTUuOFY0NTAuN2g1OTQuNWMzMi43IDAgNTkuMi0yNi41IDU5LjItNTkuMlYwSDg4MS4yeiIvPjwvc3ZnPg==",lang:"5MTEuMyA2ODMuNSI+PHBhdGggZD0iTTQ1Ni4yLjhjLTE4OC4yIDAtMzQwLjYgMTUyLjgtMzQwLjYgMzQxczE1Mi40IDM0MSAzNDAuNiAzNDFjMTg4LjYgMCAzNDEuMy0xNTIuOCAzNDEuMy0zNDFTNjQ0LjguOCA0NTYuMi44em0yMzYuMyAyMDQuNkg1OTEuOWMtMTAuOS00Mi43LTI2LjYtODMuNi00Ny0xMjEuNCA2Mi43IDIxLjQgMTE0LjkgNjUuMSAxNDcuNiAxMjEuNHpNNDU2LjYgNzAuM2MyOC4zIDQwLjkgNTAuNSA4Ni4zIDY1LjEgMTM1SDM5MS40YzE0LjctNDguNyAzNi44LTk0LjEgNjUuMi0xMzV6bS0yNjQgMzM5LjZjLTUuNS0yMS44LTguOS00NC43LTguOS02OC4yczMuNC00Ni40IDguOS02OC4yaDExNS4zYy0yLjcgMjIuNS00LjggNDUtNC44IDY4LjJzMiA0NS43IDQuOCA2OC4ySDE5Mi42em0yOCA2OC4yaDEwMC42YzEwLjkgNDIuNiAyNi42IDgzLjUgNDcuMSAxMjEuNC02Mi44LTIxLjQtMTE1LTY0LjgtMTQ3LjctMTIxLjR6bTEwMC42LTI3Mi43SDIyMC42YzMyLjctNTYuNiA4NC45LTk5LjkgMTQ3LjYtMTIxLjQtMjAuNCAzNy44LTM2LjEgNzguNy00NyAxMjEuNHptMTM1LjQgNDA3LjhjLTI4LjMtNDAuOS01MC41LTg2LjMtNjUuMS0xMzVoMTMwLjNjLTE0LjggNDguNy0zNi45IDk0LjEtNjUuMiAxMzV6bTc5LjctMjAzLjNIMzc2LjhjLTMuMS0yMi41LTUuNS00NS01LjUtNjguMnMyLjQtNDYgNS41LTY4LjJoMTU5LjZjMy4xIDIyLjIgNS41IDQ1IDUuNSA2OC4ycy0yLjUgNDUuNy01LjYgNjguMnptOC42IDE4OS42YzIwLjUtMzcuOCAzNi4xLTc4LjggNDcuMS0xMjEuNGgxMDAuNmMtMzIuOCA1Ni4zLTg1IDEwMC0xNDcuNyAxMjEuNHptNjAuMy0xODkuNmMyLjctMjIuNSA0LjgtNDUgNC44LTY4LjJzLTItNDUuNy00LjgtNjguMmgxMTUuM2M1LjUgMjEuOCA4LjkgNDQuNyA4LjkgNjguMnMtMy40IDQ2LjQtOC45IDY4LjJINjA1LjJ6Ii8+PC9zdmc+",cached:{}},M=()=>{const a=Object.keys(n).filter(a=>!1===["cached"].includes(a)),r=[];return a.forEach(a=>{r.push((a=>new Promise(r=>{if(n.cached[a])return r(n.cached[a]);const t=new Image;t.src="".concat("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA").concat(n[a]),t.onload=()=>{n.cached[a]=t,r(t)}}))(a))}),Promise.all(r)},l=(a,r,t,M,l,i)=>{const o=n.cached[i];if(!o)return;const u=o.width/o.height;e.clearRect(0,0,h.width,h.height),h.width=c.fontSize*c.resolution*1.5,h.height=h.width/u;const L=(M-h.width)/2,j=(l-h.height)/2;e.drawImage(o,0,0,h.width,h.height),e.fillStyle=a.fillStyle;const s=e.globalCompositeOperation;e.globalCompositeOperation="source-in",e.fillRect(0,0,h.width,h.height),e.globalCompositeOperation=s,a.drawImage(h,r+L,t+j,h.width,h.height)};function i(){}Object.assign(i.prototype,{addEventListener:function(a,r){void 0===this._listeners&&(this._listeners={});var t=this._listeners;void 0===t[a]&&(t[a]=[]),-1===t[a].indexOf(r)&&t[a].push(r)},removeEventListener:function(a,r){if(void 0!==this._listeners){var t=this._listeners[a];if(void 0!==t){var c=t.indexOf(r);-1!==c&&t.splice(c,1)}}},dispatchEvent:function(a){if(void 0!==this._listeners){var r=this._listeners[a.type];if(void 0!==r){a.target=this;for(var t=r.slice(0),c=0,h=t.length;c<h;c++)t[c].call(this,a)}}}});const o=new i,u=(a,t)=>{let c=null;a.length<=2&&!r.includes(a.toLowerCase())&&(c=t?a.toUpperCase():a),"space"===a&&(c=" "),o.dispatchEvent({type:L,key:a,char:c})},L="keyDown";var j=Object.freeze({__proto__:null,dispatcher:o,addEventListener:(a,r)=>{o.addEventListener(a,r)},removeEventListener:(a,r)=>{o.removeEventListener(a,r)},dispatchEvent:u,KEYDOWN:L});const s={};let N=!1;const g=Math.PI/4;let x,y=[],I=[],T=[],d=[],w=null,D=null,S=null;const z=a=>{const r=a.toString().split("\n");for(let a=0;a<r.length;a++){const t=r[a].replace("\r","");let c=null,h=null;const e=Math.min(t.length,8);for(let a=0;a<e;a++){const r=t.charAt(a);r!==h&&(null===c?(void 0===s[x][r]&&(s[x][r]={}),c=s[x][r]):(void 0===c[r]&&(c[r]={}),c=c[r])),h=r,a===e-1&&(void 0===c.words&&(c.words=[]),c.words.push(t))}}},E=(a,r,t)=>{a&&y[y.length-1]!==a.char&&a.char.length<=2&&(y.push(a.char),m(),f(a.char))},f=a=>{if(0===I.length){const r=s[x][a];A(r)}else T=[],I.forEach(r=>{if(r){const t=r[a];A(t)}});return d},A=a=>{if(!a)return;Object.keys(a).filter(a=>"words"!==a).length>0&&(I.push(a),T.push(a)),C(a)},C=a=>{const{words:r}=a;r&&(d=d.concat(r))},p=(a,r)=>{let t=y[y.length-1];if(w&&S!==t){const c=a-w.x,h=r-w.y;if(Math.sqrt(c*c+h*h)>=2){let e=Math.atan2(h,c);if(D){const a=O(e,D);Math.abs(a)>g&&(I=[...T],T=[],S=t)}D=e,w={x:a,y:r}}}w||(w={x:a,y:r})},O=(a,r)=>Math.atan2(Math.sin(a-r),Math.cos(a-r)),v=()=>{const a=y[y.length-1],r=d.filter(r=>r.charAt(r.length-1)===a);return r.sort((function(a,r){return r.length-a.length})),r},m=()=>{w=null,D=null,S=null},Y=()=>{y=[],I=[],T=[],d=[],m()},Q=document.createElement("canvas"),k=Q.getContext("2d"),b={x:0,y:0};let U=null,P=null,R=null,B=null,H=null,_=null,J=null,Z=null,X=null,W=!1,F=null,V=!1,G=!1,q=0,K=!1,$=null;const aa=a=>{t[a]&&(R=a,ra(a))},ra=a=>{H=t[a],_=a,B=ga();const r=(B+1)*J;Z=(Q.width-r)/B,Ma()},ta=(r,t,c)=>{W=r,void 0!==t?ca(t,c):ca(b.x,b.y),W||(a=>{if(N){E(a);const r=v();return Y(),r}})(a.activeElement)},ca=(r,t)=>{let c;b.x=r,b.y=t,V&&(c=ia()),c||(c=la()),W&&((a,r,t)=>{N&&(a&&p(r,t),E(a))})(a.activeElement,r,t),!c&&a.activeElement&&(ua(),Ma())},ha=()=>{Q.width=512*c.resolution,Q.height=Q.width/c.aspect,J=c.margin*c.resolution,X=c.buttonHeight*c.resolution,_&&ra(_)};a.textureDirty=!0;const ea=(a,r,t,c,h)=>{t<2*h&&(h=t/2),c<2*h&&(h=c/2),k.beginPath(),k.moveTo(a+h,r),k.arcTo(a+t,r,a+t,r+c,h),k.arcTo(a+t,r+c,a,r+c,h),k.arcTo(a,r+c,a,r,h),k.arcTo(a,r,a+t,r,h),k.closePath(),k.fill()},na=(a,r,t,h,e,n)=>{if(n||(n=c.fontSize*c.resolution),k.font="".concat(n,"px ").concat(c.font),k.textBaseline="middle",!e)return;const M=(t-k.measureText(e).width)/2,l=h/2;k.fillText(e,a+M,r+l)},Ma=()=>{const r=Na();k.clearRect(0,0,Q.width,Q.height),k.shadowBlur=c.keyShadow.shadowBlur,k.shadowOffsetX=c.keyShadow.shadowOffsetX,k.shadowOffsetY=c.keyShadow.shadowOffsetY;let t=r;for(let a=0;a<H.length;a++){const r=H[a];let h=J+xa()+ya(a);for(let a=0;a<r.length;a++){const e=r[a];let n=e.w?e.w:1;k.fillStyle=c.colors.hover,e.down?k.fillStyle=c.colors.down:e.hover?k.fillStyle=c.colors.hover:k.fillStyle=c.colors.idle;let M=Z*n;if(M+=(n-1)*J,k.shadowColor=c.keyShadow.shadowColor,ea(h,t,M,X,c.buttonRadius*c.resolution),k.shadowColor="transparent",k.fillStyle=c.colors.text,e.pos={x:h,y:t},["shift","bksp","enter","lang"].includes(e.char)){let a=e.char;"shift"===e.char&&G&&(a="shift_down"),"shift"===e.char&&K&&(a="shift_perm"),l(k,h,t,M,X,a)}else{let a=G&&1===e.char.length?e.char.toUpperCase():e.char;if("space"===a&&(a="␣"),na(h,t,M,X,a),e.alt){const a=.6*c.fontSize*c.resolution;na(h+M/2-a/2,t-X/2+a,M,X,e.alt,a)}}h+=M+J}t+=X+J}if(k.shadowBlur=c.popupShadow.shadowBlur,k.shadowOffsetX=c.popupShadow.shadowOffsetX,k.shadowOffsetY=c.popupShadow.shadowOffsetY,a.activeElement&&a.activeElement.extra&&a.activeElement.down){const{pos:r}=a.activeElement,{startX:t,startY:h,keyArr:e,popupWidth:n,popupHeight:M}=Ta(r,V?[...a.activeElement.extra]:[a.activeElement]);k.fillStyle=c.colors.idle,k.shadowColor=c.popupShadow.shadowColor,ea(t,h-X*(e.length-1),n,M,c.buttonRadius*c.resolution),ea(r.x,r.y-X,Z,2*X,c.buttonRadius*c.resolution),k.shadowColor="transparent";let l=h;for(let a=0;a<e.length;a++){const r=e[a];let h=t;for(let a=0;a<r.length;a++){const t=r[a];t.down?k.fillStyle=c.colors.down:t.hover?k.fillStyle=c.colors.hover:k.fillStyle=c.colors.idle,ea(h,l,Z,X,c.buttonRadius*c.resolution),k.fillStyle=c.colors.text;const e=G&&t.char.length<=2?t.char.toUpperCase():t.char;na(h,l,Z,X,e),V||na(h,l+X/2,Z,X/2,"..."),h+=Z}l-=X}}a.textureDirty=!0},la=()=>{const{x:r,y:t}=b,c=Na(),h=Math.floor((t-c)/(X+J)),e=H[h];if(!e)return;let n=J+xa()+ya(h);for(let t=0;t<e.length;t++){const c=e[t];let h=c.w?c.w:1,M=Z*h;M+=(h-1)*J;let l=r>n;if(n+=M+J,l&&r<n-J){if(!a.activeElement||a.activeElement!==c||a.activeElement.down!==W){if(a.activeElement===c&&a.activeElement.down&&!W)return oa(a.activeElement);ua(),a.activeElement=c,a.activeElement.hover=!0,a.activeElement.down=W,a.activeElement.down?sa():ja(),Ma()}return a.activeElement}}},ia=()=>{if(!a.activeElement||!a.activeElement.extra)return;if(!W)return oa(U),!0;const{x:r,y:t}=b,{pos:c}=a.activeElement,{startX:h,startY:e,keyArr:n,popupWidth:M,popupHeight:l}=Ta(c,[...a.activeElement.extra]);let i=null,o=Number.POSITIVE_INFINITY,u=e+X/2;for(let a=0;a<n.length;a++){const c=n[a];let e=h+Z/2;for(let a=0;a<c.length;a++){const h=c[a],n=r-e,M=t-u,l=Math.sqrt(n*n+M*M);l<o&&(i=h,o=l),e+=Z}u-=X}return U&&U===i&&U.down===W||(La(),U=i,U.hover=!0,U.down=!0,Ma()),r>h&&r<h+M&&t>e-X*(n.length-1)&&t<e-X*(n.length-1)+l||r>c.x&&r<c.x+Z&&t>c.y-X&&t<c.y+X},oa=a=>{La(),ua(),ja();let t=!0;switch(u(a.char,G),a.char){case"abc":ra(R);break;case"!?#":case"?123":ra("num");break;case"=\\<":ra("sym");break;case"1234":ra("nump");break;case"shift":!K&&Date.now()-q<300?(G=!0,K=!0,q=0):(G=!G,K=!1,q=Date.now()),t=!1;break;case"lang":for(let a=0;a<r.length;a++)if(r[a]===R){let t=a+1;r[t]||(t=0),aa(r[t]);break}break;default:r.includes(a.char.toLowerCase())?aa(a.char.toLowerCase()):(G&&!K&&(G=!1),t=!1)}return t||Ma(),a},ua=()=>{a.activeElement&&(a.activeElement.hover=!1,a.activeElement.down=!1,a.activeElement=null)},La=()=>{U&&(U.hover=!1,U.down=!1,U=null)},ja=()=>{F&&clearTimeout(F),$&&clearInterval($),V=!1},sa=()=>{ja(),F=setTimeout(()=>{V=!0,La(),ia(),a.activeElement&&"bksp"===a.activeElement.char&&($=setInterval(()=>{a.activeElement&&u(a.activeElement.char)},c.bkspIntervalTime))},c.holdPopupTime)},Na=()=>"center"===c.align?Q.height/2-H.length*X*.5:2*X+4*J,ga=()=>{let a=0;for(let r=0;r<H.length;r++){const t=H[r];let c=0;for(let a=0;a<t.length;a++){const r=t[a];c+=r.w?r.w:1}c>a&&(a=c)}return a},xa=()=>{let a=ga();const r=(B-a)/2;return r*Z+r*J},ya=a=>{const r=H[a];let t=0;for(let a=0;a<r.length;a++){const c=r[a];t+=c.w?c.w:1}const c=(B-t)/2;return c*Z+c*J},Ia=()=>(H.length*X+(H.length+1)*J+(2*X+3*J))/c.resolution,Ta=(a,r)=>{let t=5;r.length>t&&(t=Math.ceil(r.length/2));const c=new Array(Math.ceil(r.length/t)).fill().map(a=>r.splice(0,t)),h=c[0].length*Z,e=c.length*X,n=Math.floor(c[0].length/2)*Z;let M=a.x-n;for(c[0].length>1&&c[0].length%2==0&&(M+=Z);M<0;)M+=Z;for(;M+c[0].length*Z>Q.width;)M-=Z;return{keyArr:c,popupWidth:h,popupHeight:e,startX:M,startY:a.y-X-3*J}};a.addListeners=()=>{const a=(a,r)=>(P=Q.getBoundingClientRect(),a-=P.x,r-=P.y,[a*c.resolution,r*c.resolution]);document.addEventListener("mousemove",r=>{ca(...a(r.clientX,r.clientY))}),Q.addEventListener("mousedown",r=>{ta(!0,...a(r.clientX,r.clientY)),r.preventDefault()}),document.addEventListener("mouseup",a=>{ta(!1)}),document.addEventListener("touchmove",r=>{const t=r.touches[0];ca(...a(t.clientX,t.clientY)),r.preventDefault()},{passive:!1}),Q.addEventListener("touchstart",r=>{const t=r.touches[0];ta(!0,...a(t.clientX,t.clientY)),r.preventDefault()},{passive:!1}),document.addEventListener("touchend",a=>{ta(!1)},{passive:!1})},a.canvas=Q,a.events=j,a.init=a=>{var r;(r="en",x=r,N=!1,new Promise((a,t)=>{if(s[x])return a();s[x]={},fetch("".concat("./wordlist/").concat(r,".txt")).then(a=>a.text()).then(r=>{z(r),N=!0,a()}).catch(a=>{t(a)})})).then(()=>{}),M().then(()=>{Ma()}),Object.assign(c,a),R=c.language,ha(),aa("en")},a.selectLanguage=aa,a.setLayout=ra,a.setMouseDown=ta,a.setMousePos=ca,a.setMousePosFromUV=(a,r)=>{ca(Q.width*a,Q.height*r)},a.setScreenSizeFromAspectRatio=ha,a.setScreenSizeInPixels=(a,r,t)=>{c.resolution=t,X=c.buttonHeight*c.resolution,J=c.margin*c.resolution;const h=Ia();r=Math.max(r,h),Q.width=a*c.resolution,Q.height=r*c.resolution,Q.style.width="".concat(a,"px"),Q.style.height="".concat(r,"px"),_&&ra(_)},a.setTextureDirty=r=>{a.textureDirty=r},Object.defineProperty(a,"__esModule",{value:!0})}));
