const t={resolution:1,aspect:1.25,margin:5,fontSize:16,buttonHeight:40,buttonRadius:5,language:"en",languages:["en","fr","es","ru"],font:"sans-serif",align:"center",colors:{idle:"#3f4a52",hover:"#2d343a",down:"#5cb0a7",text:"#ffffff"},keyShadow:{shadowColor:"rgba(0, 0, 0, .3)",shadowBlur:1,shadowOffsetX:1,shadowOffsetY:1},popupShadow:{shadowColor:"rgba(0, 0, 0, .3)",shadowBlur:4,shadowOffsetX:0,shadowOffsetY:2},holdPopupTime:300,bkspIntervalTime:50,shiftDoubleTapTimeout:300,swipe:!0,swipeMinimumVectorLength:2,swipeMinimumAngleDifference:Math.PI/4,swipeMinimumDistance:20,swipeDrawingLifeTime:500,swipeIdleDrawInterval:50,swipeDrawingSize:6,swipeMaxWordDepth:8,swipeLoadingFontSize:12,suggestionCrawlStep:100,layouts:{en:[[{char:"q",extra:[{char:"1"}],alt:"1"},{char:"w",extra:[{char:"2"}],alt:"2"},{char:"e",extra:[{char:"è"},{char:"3"},{char:"é"},{char:"ê"},{char:"ę"},{char:"ë"},{char:"ē"},{char:"ė"}],alt:"3"},{char:"r",extra:[{char:"4"}],alt:"4"},{char:"t",extra:[{char:"5"}],alt:"5"},{char:"y",extra:[{char:"ý"},{char:"6"},{char:"ĳ"},{char:"ÿ"}],alt:"6"},{char:"u",extra:[{char:"û"},{char:"7"},{char:"ú"},{char:"ū"},{char:"ü"},{char:"ù"}],alt:"7"},{char:"i",extra:[{char:"î"},{char:"8"},{char:"í"},{char:"ï"},{char:"į"},{char:"ī"},{char:"ì"},{char:"ĳ"}],alt:"8"},{char:"o",extra:[{char:"ò"},{char:"ö"},{char:"ô"},{char:"9"},{char:"ó"},{char:"õ"},{char:"ō"},{char:"œ"},{char:"ø"}],alt:"9"},{char:"p",extra:[{char:"0"}],alt:"0"}],[{char:"a",extra:[{char:"à"},{char:"á"},{char:"â"},{char:"ä"},{char:"æ"},{char:"ã"},{char:"å"},{char:"ā"},{char:"ª"}]},{char:"s",extra:[{char:"ß"}]},{char:"d"},{char:"f"},{char:"g"},{char:"h"},{char:"j",extra:[{char:"j́"}]},{char:"k"},{char:"l"}],[{char:"shift",w:1.5},{char:"z"},{char:"x"},{char:"c",extra:[{char:"ç"}]},{char:"v"},{char:"b"},{char:"n",extra:[{char:"ñ"},{char:"ń"}]},{char:"m"},{char:"bksp",w:1.5}],[{char:"?123",w:2},{char:","},{char:"lang"},{char:"space",w:3},{char:"."},{char:"enter",w:2}]],fr:[[{char:"a",extra:[{char:"à"},{char:"á"},{char:"1"},{char:"â"},{char:"ä"},{char:"æ"},{char:"ã"},{char:"å"},{char:"ā"},{char:"ª"}],alt:"1"},{char:"z",extra:[{char:"2"}],alt:"2"},{char:"e",extra:[{char:"è"},{char:"3"},{char:"é"},{char:"ê"},{char:"ę"},{char:"ë"},{char:"ē"},{char:"ė"}],alt:"3"},{char:"r",extra:[{char:"4"}],alt:"4"},{char:"t",extra:[{char:"5"}],alt:"5"},{char:"y",extra:[{char:"ý"},{char:"6"},{char:"ĳ"},{char:"ÿ"}],alt:"6"},{char:"u",extra:[{char:"û"},{char:"7"},{char:"ú"},{char:"ū"},{char:"ü"},{char:"ù"}],alt:"7"},{char:"i",extra:[{char:"î"},{char:"8"},{char:"í"},{char:"ï"},{char:"į"},{char:"ī"},{char:"ì"},{char:"ĳ"}],alt:"8"},{char:"o",extra:[{char:"ò"},{char:"ö"},{char:"ô"},{char:"9"},{char:"ó"},{char:"õ"},{char:"ō"},{char:"œ"},{char:"ø"}],alt:"9"},{char:"p",extra:[{char:"0"}],alt:"0"}],[{char:"q"},{char:"s",extra:[{char:"ß"}]},{char:"d"},{char:"f"},{char:"g"},{char:"h"},{char:"j",extra:[{char:"j́"}]},{char:"k"},{char:"l"},{char:"m"}],[{char:"shift",w:1.5},{char:"w"},{char:"x"},{char:"c",extra:[{char:"ç"}]},{char:"v"},{char:"b"},{char:"n",extra:[{char:"ñ"},{char:"ń"}]},{char:"'",extra:[{char:"‚"},{char:"‘"},{char:"’"},{char:"‹"},{char:"›"}]},{char:"bksp",w:1.5}],[{char:"?123",w:2},{char:","},{char:"lang"},{char:"space",w:3},{char:"."},{char:"enter",w:2}]],es:[[{char:"q",extra:[{char:"1"}],alt:"1"},{char:"w",extra:[{char:"2"}],alt:"2"},{char:"e",extra:[{char:"è"},{char:"3"},{char:"é"},{char:"ê"},{char:"ę"},{char:"ë"},{char:"ē"},{char:"ė"}],alt:"3"},{char:"r",extra:[{char:"4"}],alt:"4"},{char:"t",extra:[{char:"5"}],alt:"5"},{char:"y",extra:[{char:"ý"},{char:"6"},{char:"ĳ"},{char:"ÿ"}],alt:"6"},{char:"u",extra:[{char:"û"},{char:"7"},{char:"ú"},{char:"ū"},{char:"ü"},{char:"ù"}],alt:"7"},{char:"i",extra:[{char:"î"},{char:"8"},{char:"í"},{char:"ï"},{char:"į"},{char:"ī"},{char:"ì"},{char:"ĳ"}],alt:"8"},{char:"o",extra:[{char:"ò"},{char:"ö"},{char:"ô"},{char:"9"},{char:"ó"},{char:"õ"},{char:"ō"},{char:"œ"},{char:"ø"}],alt:"9"},{char:"p",extra:[{char:"0"}],alt:"0"}],[{char:"a",extra:[{char:"à"},{char:"á"},{char:"â"},{char:"ä"},{char:"æ"},{char:"ã"},{char:"å"},{char:"ā"},{char:"ª"}]},{char:"s",extra:[{char:"ß"}]},{char:"d"},{char:"f"},{char:"g"},{char:"h"},{char:"j",extra:[{char:"j́"}]},{char:"k"},{char:"l"},{char:"ñ"}],[{char:"shift",w:1.5},{char:"z"},{char:"x"},{char:"c",extra:[{char:"ç"}]},{char:"v"},{char:"b"},{char:"n",extra:[{char:"ñ"},{char:"ń"}]},{char:"m"},{char:"bksp",w:1.5}],[{char:"?123",w:2},{char:","},{char:"lang"},{char:"space",w:3},{char:"."},{char:"enter",w:2}]],ru:[[{char:"й",extra:[{char:"1"}],alt:"1"},{char:"ц",extra:[{char:"2"}],alt:"2"},{char:"у",extra:[{char:"3"},{char:"у́"}],alt:"3"},{char:"к",extra:[{char:"4"}],alt:"4"},{char:"е",extra:[{char:"е́"},{char:"5"},{char:"ё"}],alt:"5"},{char:"н",extra:[{char:"6"}],alt:"6"},{char:"г",extra:[{char:"7"},{char:"ґ"}],alt:"7"},{char:"ш",extra:[{char:"8"}],alt:"8"},{char:"щ",extra:[{char:"9"}],alt:"9"},{char:"з",extra:[{char:"0"}],alt:"0"},{char:"х"}],[{char:"ф"},{char:"ы",extra:[{char:"ы́"}]},{char:"в"},{char:"а",extra:[{char:"а́"}]},{char:"п"},{char:"р"},{char:"о",extra:[{char:"о́"}]},{char:"л"},{char:"д"},{char:"ж"},{char:"э",extra:[{char:"є"},{char:"э́"}]}],[{char:"shift"},{char:"я",extra:[{char:"я́"}]},{char:"ч"},{char:"с"},{char:"м"},{char:"и",extra:[{char:"ї"},{char:"и́"},{char:"і"}]},{char:"т"},{char:"ь",extra:[{char:"ъ"}]},{char:"б"},{char:"ю",extra:[{char:"ю́"}]},{char:"bksp"}],[{char:"?123",w:2},{char:","},{char:"lang"},{char:"space",w:4},{char:"."},{char:"enter",w:2}]],num:[[{char:"1",extra:[{char:"¹"},{char:"½"},{char:"⅓"},{char:"¼"},{char:"⅕"},{char:"⅙"},{char:"⅐"},{char:"⅛"},{char:"⅑"},{char:"⅒"}]},{char:"2",extra:[{char:"⅖"},{char:"²"},{char:"⅔"}]},{char:"3",extra:[{char:"⅗"},{char:"³"},{char:"¾"},{char:"⅜"}]},{char:"4",extra:[{char:"⁴"},{char:"⅘"}]},{char:"5",extra:[{char:"⅝"},{char:"⁵"},{char:"⅚"}]},{char:"6",extra:[{char:"⁶"}]},{char:"7",extra:[{char:"⁷"},{char:"⅞"}]},{char:"8",extra:[{char:"⁸"}]},{char:"9",extra:[{char:"⁹"}]},{char:"0",extra:[{char:"∅"},{char:"ⁿ"},{char:"⁰"}]}],[{char:"@"},{char:"#",extra:[{char:"№"}]},{char:"$",extra:[{char:"₱"},{char:"€"},{char:"¢"},{char:"£"},{char:"¥"}]},{char:"_"},{char:"&"},{char:"-",extra:[{char:"—"},{char:"_"},{char:"–"},{char:"·"}]},{char:"+",extra:[{char:"±"}]},{char:"(",extra:[{char:"["},{char:"<"},{char:"{"}]},{char:")",extra:[{char:"]"},{char:">"},{char:"}"}]},{char:"/"}],[{char:"=\\<",w:1.5},{char:"*",extra:[{char:"★"},{char:"†"},{char:"‡"}]},{char:'"',extra:[{char:"„"},{char:"“"},{char:"”"},{char:"«"},{char:"»"}]},{char:"'",extra:[{char:"‚"},{char:"‘"},{char:"’"},{char:"‹"},{char:"›"}]},{char:":"},{char:";"},{char:"!",extra:[{char:"¡"}]},{char:"?",extra:[{char:"¿"},{char:"‽"}]},{char:"bksp",w:1.5}],[{char:"abc",w:1.5},{char:","},{char:"1234"},{char:"space",w:4},{char:"."},{char:"enter",w:1.5}]],nump:[[{char:"+",extra:[{char:"-"}]},{char:"1",w:2},{char:"2",w:2},{char:"3",w:2},{char:"%"}],[{char:"*"},{char:"4",w:2},{char:"5",w:2},{char:"6",w:2},{char:"space"}],[{char:"/"},{char:"7",w:2},{char:"8",w:2},{char:"9",w:2},{char:"bksp"}],[{char:"abc"},{char:","},{char:"!?#"},{char:"0",w:2},{char:"="},{char:"."},{char:"enter"}]],sym:[[{char:"〜"},{char:"`"},{char:"|"},{char:"•",extra:[{char:"♣"},{char:"♠"},{char:"♪"},{char:"♥"},{char:"♦"}]},{char:"√"},{char:"π",extra:[{char:"Ω"},{char:"Π"},{char:"μ"}]},{char:"÷"},{char:"×"},{char:"¶",extra:["§"]},{char:"Δ"}],[{char:"£"},{char:"€"},{char:"$",extra:[{char:"₱"},{char:"€"},{char:"¢"},{char:"£"},{char:"¥"}]},{char:"¢"},{char:"^",extra:[{char:"←"},{char:"↑"},{char:"↓"},{char:"→"}]},{char:"°",extra:[{char:"′"},{char:"″"}]},{char:"=",extra:[{char:"∞"},{char:"≠"},{char:"≈"}]},{char:"{",extra:[{char:"("}]},{char:"}",extra:[{char:")"}]},{char:"\\"}],[{char:"?123",w:1.5},{char:"%",extra:[{char:"‰"},{char:"℅"}]},{char:"©"},{char:"®"},{char:"™"},{char:"✓"},{char:"["},{char:"]"},{char:"bksp",w:1.5}],[{char:"abc",w:1.5},{char:"<"},{char:"space",w:5},{char:">"},{char:"enter",w:1.5}]]}},e=document.createElement("canvas"),a=e.getContext("2d"),r={bksp:"5MTEuMyA2ODMuNSI+PHBhdGggZD0iTTgzNS40IDBIMjY1LjhjLTI2LjIgMC00Ni43IDEzLjMtNjAuNCAzMy40TDAgMzQxLjhsMjA1LjQgMzA4YzEzLjcgMjAuMSAzNC4yIDMzLjggNjAuNCAzMy44aDU2OS42YzQxLjggMCA3NS45LTM0LjIgNzUuOS03NS45Vjc1LjljMC00MS43LTM0LjEtNzUuOS03NS45LTc1Ljl6bTAgNjA3LjZIMjY4LjVMOTEuMSAzNDEuOCAyNjguMSA3Nmg1NjcuM3Y1MzEuNnptLTQ0MC4xLTc2bDEzNi4zLTEzNi4zIDEzNi4zIDEzNi4zIDUzLjUtNTMuNS0xMzYuMi0xMzYuMyAxMzYuMy0xMzYuM0w2NjggMTUyIDUzMS42IDI4OC4yIDM5NS4zIDE1MS45bC01My41IDUzLjUgMTM2LjMgMTM2LjMtMTM2LjMgMTM2LjQgNTMuNSA1My41eiIvPjwvc3ZnPg==",shift:"5MTEuMyA2ODcuNSI+PHBhdGggZD0iTTQ1NS42IDY4Ny41Yy0zMy43IDAtNjUuNC0uMi04OS40LS41LTQ1LjItLjYtNDguMi0xLjQtNTIuOC0yLjgtMTcuMy00LjktMzIuMS0xNy45LTM5LjYtMzQuN2wtNS44LTEyLjgtLjMtMTMwLjctLjItOTFoLTM4LjRjLTQxLjYgMC02MC42IDAtNzIuNC0xLjEtMTQtMS4zLTI5LjYtNS4xLTM5LjQtMjQuMS01LjktMTEuMy05LjUtMjkuNCA3LTUxLjJsLjEtLjJjNi4xLTggMTEzLjEtMTI3LjcgMTQ1LjctMTY0LjIgMzYuNS00MC44IDcwLjYtNzguOSA5Ni4yLTEwNy40QzQxMiAxNS45IDQxMi42IDE1LjQgNDE1LjggMTNsLjUtLjRjNS44LTQuMyAxMy4zLTcuOCAxOC05LjVsLjUtLjJjMTYuOS01LjcgMzcuMi0zLjYgNTMuMSA1LjRsLjEuMWM5LjIgNS4zIDExLjEgNi4zIDE1Ny4xIDE2OS44IDU1LjIgNjEuNyA4OS42IDEwMC41IDExMS44IDEyNS44IDM1LjQgNDAuNCAzNi42IDQyLjkgMzkgNDkuMyA4LjggMjIuOC0uNSA0Ni0yMi44IDU2LjRsLS45LjRjLTExLjUgNC45LTE3LjQgNC45LTg5LjMgNC45SDY0NGwtLjIgOTEtLjQgMTMwLjctNS43IDEyLjdjLTcuNCAxNi44LTIyLjMgMjkuOC0zOS43IDM0LjgtNS4yIDEuNS0xMiAzLjMtMTQyLjQgMy4zek01NzcuOCA2MjNzMCAuMSAwIDB6bS0yNDQuMy0yLjFjMzcuOSAxLjYgMjA2LjYgMS42IDI0NC41IDBsLjMtMTE1IC4zLTE1Ni4yaDEzMWMtMjcuNC0zMS4zLTcxLTgwLjEtMTEzLjUtMTI3LjdDNTE2LjMgMTMyLjggNDY4LjggNzkuOSA0NTUgNjYuMiA0MjcuNiA5NiAyNjUuNSAyNzcuNCAyMDEuNCAzNDkuN2gxMzEuM0wzMzMgNTA2bC41IDExNC45eiIvPjwvc3ZnPg==",shift_perm:"5MTEuMyA4MzMuNCI+PHBhdGggZD0iTTQ1NS41IDY4Ny44Yy0zMy43IDAtNjUuNC0uMi04OS40LS41LTQ1LjItLjYtNDguMi0xLjQtNTIuOC0yLjgtMTcuMy00LjktMzIuMS0xNy45LTM5LjYtMzQuN0wyNjggNjM3bC0uNC0xMzAuNy0uMi05MUgyMjljLTQxLjYgMC02MC42IDAtNzIuNC0xLjEtMTQtMS4zLTI5LjYtNS4xLTM5LjQtMjQuMS01LjktMTEuMy05LjUtMjkuNCA3LTUxLjJsLjEtLjJjNi4xLTggMTEzLjEtMTI3LjcgMTQ1LjctMTY0LjIgMzYuNS00MC44IDcwLjYtNzguOSA5Ni4yLTEwNy40IDQ1LjctNTAuOSA0Ni40LTUxLjQgNDkuNS01My44bC41LS40YzUuOC00LjMgMTMuMy03LjggMTgtOS41bC41LS4yYzE2LjktNS43IDM3LjItMy42IDUzLjEgNS40bC4xLjFDNDk3LjEgMTQgNDk5IDE1IDY0NSAxNzguNWM1NS4yIDYxLjcgODkuNiAxMDAuNSAxMTEuOCAxMjUuOCAzNS40IDQwLjQgMzYuNiA0Mi45IDM5IDQ5LjMgOC44IDIyLjgtLjUgNDYtMjIuOCA1Ni40bC0uOS40Yy0xMS41IDQuOS0xNy40IDQuOS04OS4zIDQuOUg2NDRsLS4yIDkxLS41IDEzMC43LTUuNyAxMi43Yy03LjQgMTYuOC0yMi4zIDI5LjgtMzkuNyAzNC44LTUuMiAxLjUtMTIgMy4zLTE0Mi40IDMuM3ptMTIyLjItNjQuNXMwIC4xIDAgMHoiLz48cGF0aCBkPSJNMzAzLjggNzk3LjRoMzA0IiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iNzIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIi8+PC9zdmc+",shift_down:"5MTEuMyA2ODcuNSI+PHBhdGggZD0iTTQ1NS42IDY4Ny41Yy0zMy43IDAtNjUuNC0uMi04OS40LS41LTQ1LjItLjYtNDguMi0xLjQtNTIuOC0yLjgtMTcuMy00LjktMzIuMS0xNy45LTM5LjYtMzQuN2wtNS44LTEyLjgtLjMtMTMwLjctLjItOTFoLTM4LjRjLTQxLjYgMC02MC42IDAtNzIuNC0xLjEtMTQtMS4zLTI5LjYtNS4xLTM5LjQtMjQuMS01LjktMTEuMy05LjUtMjkuNCA3LTUxLjJsLjEtLjJjNi4xLTggMTEzLjEtMTI3LjcgMTQ1LjctMTY0LjIgMzYuNS00MC44IDcwLjYtNzguOSA5Ni4yLTEwNy40QzQxMiAxNS45IDQxMi42IDE1LjQgNDE1LjggMTNsLjUtLjRjNS44LTQuMyAxMy4zLTcuOCAxOC05LjVsLjUtLjJjMTYuOS01LjcgMzcuMi0zLjYgNTMuMSA1LjRsLjEuMWM5LjIgNS4zIDExLjEgNi4zIDE1Ny4xIDE2OS44IDU1LjIgNjEuNyA4OS42IDEwMC41IDExMS44IDEyNS44IDM1LjQgNDAuNCAzNi42IDQyLjkgMzkgNDkuMyA4LjggMjIuOC0uNSA0Ni0yMi44IDU2LjRsLS45LjRjLTExLjUgNC45LTE3LjQgNC45LTg5LjMgNC45SDY0NGwtLjIgOTEtLjQgMTMwLjctNS43IDEyLjdjLTcuNCAxNi44LTIyLjMgMjkuOC0zOS43IDM0LjgtNS4yIDEuNS0xMiAzLjMtMTQyLjQgMy4zek01NzcuOCA2MjNzMCAuMSAwIDB6Ii8+PC9zdmc+",enter:"xMDAwIDY4Ny41Ij48cGF0aCBkPSJNODgxLjIgMHYzMzIuNUgzNDUuOVY5NS43TC0uMyAzOTEuN2wzNDYuMiAyOTUuOFY0NTAuN2g1OTQuNWMzMi43IDAgNTkuMi0yNi41IDU5LjItNTkuMlYwSDg4MS4yeiIvPjwvc3ZnPg==",lang:"5MTEuMyA2ODMuNSI+PHBhdGggZD0iTTQ1Ni4yLjhjLTE4OC4yIDAtMzQwLjYgMTUyLjgtMzQwLjYgMzQxczE1Mi40IDM0MSAzNDAuNiAzNDFjMTg4LjYgMCAzNDEuMy0xNTIuOCAzNDEuMy0zNDFTNjQ0LjguOCA0NTYuMi44em0yMzYuMyAyMDQuNkg1OTEuOWMtMTAuOS00Mi43LTI2LjYtODMuNi00Ny0xMjEuNCA2Mi43IDIxLjQgMTE0LjkgNjUuMSAxNDcuNiAxMjEuNHpNNDU2LjYgNzAuM2MyOC4zIDQwLjkgNTAuNSA4Ni4zIDY1LjEgMTM1SDM5MS40YzE0LjctNDguNyAzNi44LTk0LjEgNjUuMi0xMzV6bS0yNjQgMzM5LjZjLTUuNS0yMS44LTguOS00NC43LTguOS02OC4yczMuNC00Ni40IDguOS02OC4yaDExNS4zYy0yLjcgMjIuNS00LjggNDUtNC44IDY4LjJzMiA0NS43IDQuOCA2OC4ySDE5Mi42em0yOCA2OC4yaDEwMC42YzEwLjkgNDIuNiAyNi42IDgzLjUgNDcuMSAxMjEuNC02Mi44LTIxLjQtMTE1LTY0LjgtMTQ3LjctMTIxLjR6bTEwMC42LTI3Mi43SDIyMC42YzMyLjctNTYuNiA4NC45LTk5LjkgMTQ3LjYtMTIxLjQtMjAuNCAzNy44LTM2LjEgNzguNy00NyAxMjEuNHptMTM1LjQgNDA3LjhjLTI4LjMtNDAuOS01MC41LTg2LjMtNjUuMS0xMzVoMTMwLjNjLTE0LjggNDguNy0zNi45IDk0LjEtNjUuMiAxMzV6bTc5LjctMjAzLjNIMzc2LjhjLTMuMS0yMi41LTUuNS00NS01LjUtNjguMnMyLjQtNDYgNS41LTY4LjJoMTU5LjZjMy4xIDIyLjIgNS41IDQ1IDUuNSA2OC4ycy0yLjUgNDUuNy01LjYgNjguMnptOC42IDE4OS42YzIwLjUtMzcuOCAzNi4xLTc4LjggNDcuMS0xMjEuNGgxMDAuNmMtMzIuOCA1Ni4zLTg1IDEwMC0xNDcuNyAxMjEuNHptNjAuMy0xODkuNmMyLjctMjIuNSA0LjgtNDUgNC44LTY4LjJzLTItNDUuNy00LjgtNjguMmgxMTUuM2M1LjUgMjEuOCA4LjkgNDQuNyA4LjkgNjguMnMtMy40IDQ2LjQtOC45IDY4LjJINjA1LjJ6Ii8+PC9zdmc+",cached:{}},c=()=>{const t=Object.keys(r).filter(t=>!1===["cached"].includes(t)),e=[];return t.forEach(t=>{e.push((t=>new Promise(e=>{if(r.cached[t])return e(r.cached[t]);const a=new Image;a.src="".concat("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA").concat(r[t]),a.onload=()=>{r.cached[t]=a,e(a)}}))(t))}),Promise.all(e)},h=(c,h,n,i,o,s)=>{const u=r.cached[s];if(!u)return;const l=u.width/u.height;a.clearRect(0,0,e.width,e.height),e.width=t.fontSize*t.resolution*1.5,e.height=e.width/l;const g=(i-e.width)/2,M=(o-e.height)/2;a.drawImage(u,0,0,e.width,e.height),a.fillStyle=c.fillStyle;const L=a.globalCompositeOperation;a.globalCompositeOperation="source-in",a.fillRect(0,0,e.width,e.height),a.globalCompositeOperation=L,c.drawImage(e,h+g,n+M,e.width,e.height)},n={canvas:document.createElement("canvas"),activeElement:null,activePopupElement:null,activeSuggestionElement:null,mouseDown:!1,previousMouseState:!1,mousePos:{x:0,y:0},textureDirty:!0,selectedLanguage:null,layout:null,currentLayout:null,margin:null,buttonSize:null,buttonHeight:null,shiftDown:!1,shiftDownTime:null,perfmaShift:!1,keyPopup:!1,widthUnits:null,holdTimeout:null,bkspInterval:null,swipeActive:!1,swipePoints:[],swipeDrawInterval:null,swipePlacedWord:!1,swipeLoadingProgress:0,suggestions:[],uninterruptedString:"",stateChange:!1},i=document.createElement("canvas"),o=()=>"center"===t.align?i.height/2-n.layout.length*n.buttonHeight*.5:2*n.buttonHeight+4*n.margin,s=()=>{let t=0;for(let e=0;e<n.layout.length;e++){const a=n.layout[e];let r=0;for(let t=0;t<a.length;t++){const e=a[t];r+=e.w?e.w:1}r>t&&(t=r)}return t},u=()=>{let t=s();const e=(n.widthUnits-t)/2;return e*n.buttonSize+e*n.margin},l=t=>{const e=n.layout[t];let a=0;for(let t=0;t<e.length;t++){const r=e[t];a+=r.w?r.w:1}const r=(n.widthUnits-a)/2;return r*n.buttonSize+r*n.margin},g=(t,e)=>{let a=5;e.length>a&&(a=Math.ceil(e.length/2));const r=new Array(Math.ceil(e.length/a)).fill().map(t=>e.splice(0,a)),c=r[0].length*n.buttonSize,h=r.length*n.buttonHeight,o=Math.floor(r[0].length/2)*n.buttonSize;let s=t.x-o;for(r[0].length>1&&r[0].length%2==0&&(s+=n.buttonSize);s<0;)s+=n.buttonSize;for(;s+r[0].length*n.buttonSize>i.width;)s-=n.buttonSize;return{keyArr:r,popupWidth:c,popupHeight:h,startX:s,startY:t.y-n.buttonHeight-3*n.margin}},M=()=>{const t=n.suggestions.slice(0,3),e=3*n.buttonSize;return{suggestions:t,suggestionSize:e,totalWidth:t.length*(e+n.margin)-n.margin}},L=(t,e)=>{const a=t.x-e.x,r=t.y-e.y;return Math.sqrt(a*a+r*r)},j=(t,e)=>{const a=t.x-e.x,r=t.y-e.y;return Math.atan2(r,a)},w=t=>{let e="";for(let a=0;a<t.length;a++)-1===e.indexOf(t.charAt(a))&&(e+=t[a]);return e};function p(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function N(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function d(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?N(Object(a),!0).forEach((function(e){p(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var S={compareTwoStrings:y,findBestMatch:function(t,e){if(!function(t,e){return"string"==typeof t&&(!!Array.isArray(e)&&(!!e.length&&!e.find(t=>"string"!=typeof t)))}(t,e))throw new Error("Bad arguments: First argument should be a string, second should be an array of strings");const a=[];let r=0;for(let c=0;c<e.length;c++){const h=e[c],n=y(t,h);a.push({target:h,rating:n}),n>a[r].rating&&(r=c)}const c=a[r];return{ratings:a,bestMatch:c,bestMatchIndex:r}}};function y(t,e){if(t=t.replace(/\s+/g,""),e=e.replace(/\s+/g,""),!t.length&&!e.length)return 1;if(!t.length||!e.length)return 0;if(t===e)return 1;if(1===t.length&&1===e.length)return 0;if(t.length<2||e.length<2)return 0;let a=new Map;for(let e=0;e<t.length-1;e++){const r=t.substring(e,e+2),c=a.has(r)?a.get(r)+1:1;a.set(r,c)}let r=0;for(let t=0;t<e.length-1;t++){const c=e.substring(t,t+2),h=a.has(c)?a.get(c):0;h>0&&(a.set(c,h-1),r++)}return 2*r/(t.length+e.length-2)}const x=i.getContext("2d"),f=(t,e,a,r,c)=>{a<2*c&&(c=a/2),r<2*c&&(c=r/2),x.beginPath(),x.moveTo(t+c,e),x.arcTo(t+a,e,t+a,e+r,c),x.arcTo(t+a,e+r,t,e+r,c),x.arcTo(t,e+r,t,e,c),x.arcTo(t,e,t+a,e,c),x.closePath(),x.fill()},D=(e,a,r,c,h,i)=>{if(i||(i=t.fontSize*t.resolution),x.font="".concat(i,"px ").concat(t.font),x.textBaseline="middle",!h)return;if(h.length>2){let e=x.measureText(h);for(;i>4&&e.width>r-2*n.margin;)i--,x.font="".concat(i,"px ").concat(t.font),e=x.measureText(h)}const o=(r-x.measureText(h).width)/2,s=c/2;x.fillText(h,e+o,a+s)},m=(e,a,r,c,h,n,i)=>{const o=j({x:c,y:h},{x:e,y:a})+Math.PI/2;x.fillStyle=t.colors.down;const s=new Path2D;return s.arc(e,a,r,o,o+Math.PI),s.arc(c,h,n,o+Math.PI,o),s.closePath(),x.beginPath(),x.fill(s),x.closePath(),x},I=()=>{x.clearRect(0,0,i.width,i.height),(()=>{const e=o();x.shadowBlur=t.keyShadow.shadowBlur,x.shadowOffsetX=t.keyShadow.shadowOffsetX,x.shadowOffsetY=t.keyShadow.shadowOffsetY;let a=e;for(let e=0;e<n.layout.length;e++){const r=n.layout[e];let c=n.margin+u()+l(e);for(let e=0;e<r.length;e++){const i=r[e];let o=i.w?i.w:1;x.fillStyle=t.colors.hover,i.down?x.fillStyle=t.colors.down:i.hover?x.fillStyle=t.colors.hover:x.fillStyle=t.colors.idle;let s=n.buttonSize*o;if(s+=(o-1)*n.margin,x.shadowColor=t.keyShadow.shadowColor,f(c,a,s,n.buttonHeight,t.buttonRadius*t.resolution),x.shadowColor="transparent",x.fillStyle=t.colors.text,i.pos={x:c,y:a},["shift","bksp","enter","lang"].includes(i.char)){let t=i.char;"shift"===i.char&&n.shiftDown&&(t="shift_down"),"shift"===i.char&&n.permaShift&&(t="shift_perm"),h(x,c,a,s,n.buttonHeight,t)}else{let e=n.shiftDown&&1===i.char.length?i.char.toUpperCase():i.char;if("space"===e&&(e="␣"),D(c,a,s,n.buttonHeight,e),i.alt){const e=.6*t.fontSize*t.resolution;D(c+s/2-e/2,a-n.buttonHeight/2+e,s,n.buttonHeight,i.alt,e)}}c+=s+n.margin}a+=n.buttonHeight+n.margin}})(),t.swipe&&((()=>{if(n.suggestions.length>0){const e=o()-n.buttonHeight-3*n.margin,{suggestions:a,suggestionSize:r,totalWidth:c}=M();let h=i.width/2-c/2;a.forEach(a=>{a.down?x.fillStyle=t.colors.down:a.hover?x.fillStyle=t.colors.hover:x.fillStyle=t.colors.idle,f(h,e,r,n.buttonHeight,t.buttonRadius*t.resolution),x.fillStyle=t.colors.text,D(h,e,r,n.buttonHeight,a.char),h+=r+n.margin})}})(),(()=>{if(n.swipeLoadingProgress<1){const e=120*t.resolution,a=1.5*t.swipeLoadingFontSize*t.resolution,r=i.width/2-e/2,c=o()-a-n.margin;x.fillStyle=t.colors.idle,f(r,c,e,a,t.buttonRadius*t.resolution),x.fillStyle=t.colors.text;const h=t.swipeLoadingFontSize*t.resolution;D(r,c,e,t.fontSize*t.resolution,"loading swipe ".concat(Math.floor(100*n.swipeLoadingProgress),"%"),h)}})()),(()=>{if(x.shadowBlur=t.popupShadow.shadowBlur,x.shadowOffsetX=t.popupShadow.shadowOffsetX,x.shadowOffsetY=t.popupShadow.shadowOffsetY,n.activeElement&&n.activeElement.extra&&n.activeElement.down&&!n.swipeActive){const{pos:e}=n.activeElement,{startX:a,startY:r,keyArr:c,popupWidth:h,popupHeight:i}=g(e,n.keyPopup?[...n.activeElement.extra]:[n.activeElement]);x.fillStyle=t.colors.idle,x.shadowColor=t.popupShadow.shadowColor,f(a,r-n.buttonHeight*(c.length-1),h,i,t.buttonRadius*t.resolution),f(e.x,e.y-n.buttonHeight,n.buttonSize,2*n.buttonHeight,t.buttonRadius*t.resolution),x.shadowColor="transparent";let o=r;for(let e=0;e<c.length;e++){const r=c[e];let h=a;for(let e=0;e<r.length;e++){const a=r[e];a.down?x.fillStyle=t.colors.down:a.hover?x.fillStyle=t.colors.hover:x.fillStyle=t.colors.idle,f(h,o,n.buttonSize,n.buttonHeight,t.buttonRadius*t.resolution),x.fillStyle=t.colors.text;const c=n.shiftDown&&a.char.length<=2?a.char.toUpperCase():a.char;D(h,o,n.buttonSize,n.buttonHeight,c),n.keyPopup||D(h,o+n.buttonHeight/2,n.buttonSize,n.buttonHeight/2,"..."),h+=n.buttonSize}o-=n.buttonHeight}}})(),t.swipe&&(()=>{if(n.swipePoints.length>1){n.swipeDrawInterval||(n.swipeDrawInterval=setInterval(I,t.swipeIdleDrawInterval));for(let e=1;e<n.swipePoints.length;e++){const a=n.swipePoints[e-1],r=(Date.now()-a.t)/t.swipeDrawingLifeTime,c=t.swipeDrawingSize*(1-r),h=n.swipePoints[e],i=(Date.now()-h.t)/t.swipeDrawingLifeTime,o=t.swipeDrawingSize*(1-i);r>=1?(n.swipePoints.splice(e-1,1),e--):m(a.x,a.y,c,h.x,h.y,o)}}else n.swipeDrawInterval&&(clearInterval(n.swipeDrawInterval),n.swipeDrawInterval=null)})(),n.stateChange=!1,n.textureDirty=!0},T={};let E=!1,z=[],v=[],b=[],A=[],C=null,O=null,P=null,Y=null,k=0,Q=null,U=null;const H=()=>{n.swipeLoadingProgress=1,E=!0,I()},W=e=>{R();const a=e.toString().split("\n");for(let e=0;e<a.length;e++){const r=a[e].replace("\r","");if(1===r.length)continue;let c=null,h=null;const i=Math.min(r.length,t.swipeMaxWordDepth);for(let t=0;t<i;t++){const e=J(r.charAt(t));e!==h&&(null===c?(void 0===T[n.selectedLanguage][e]&&(T[n.selectedLanguage][e]={}),c=T[n.selectedLanguage][e]):(void 0===c[e]&&(c[e]={}),c=c[e])),0===t&&(void 0===c.allWords&&(c.allWords=[]),c.allWords.push(r)),t===i-1&&(void 0===c.words&&(c.words=[]),c.words.push(r)),h=e}}},R=()=>{T[n.selectedLanguage].specialCharacterMap={};const{specialCharacterMap:t}=T[n.selectedLanguage];n.layout.forEach(e=>{e.forEach(e=>{e.char.length<=2&&e.extra&&e.extra.forEach(a=>{t[a.char]=e.char})})})},B=()=>{E&&(_(),n.swipeActive?(q(),n.uninterruptedString=""):$(n.uninterruptedString),ct())},J=t=>{let e=T[n.selectedLanguage].specialCharacterMap[t];return void 0!==e?e:t},_=()=>{const t=n.activeElement;if(!t)return;const e=J(t.char);z[z.length-1]===e||e.length>2||(z.push(e),et(),X(e))},X=t=>{if(0===v.length){const e=T[n.selectedLanguage][t];Z(e)}else b=[],v.forEach(e=>{if(e){const a=e[t];Z(a)}})},Z=t=>{if(!t)return;Object.keys(t).filter(t=>"words"!==t).length>0&&(v.push(t),b.push(t)),F(t)},F=t=>{const{words:e}=t;e&&(A=A.concat(e))},V=()=>{if(!O)return void(O=d({},n.mousePos));let e=z[z.length-1];if(Y===e)return;if(L(n.mousePos,O)>=t.swipeMinimumVectorLength){let a=j(n.mousePos,O);if(P){const r=G(a,P);Math.abs(r)>t.swipeMinimumAngleDifference&&(v=[...b],b=[],Y=e)}P=a,O=d({},n.mousePos)}},G=(t,e)=>Math.atan2(Math.sin(t-e),Math.cos(t-e)),q=()=>{const t=z[z.length-1];let e=A.filter(e=>J(e.charAt(e.length-1))===t);e.sort((function(t,e){return w(e).length-w(t).length})),e=e.filter((t,e,a)=>a.indexOf(t)===e),K(e)},$=(e,a=!1,r=[])=>{if(a||at(),""===e)return void(n.suggestions=[]);const c=J(e.charAt(0)),h=T[n.selectedLanguage][c];if(!h||!h.allWords)return void(n.suggestions=[]);const i=h.allWords,o=i.slice(k,k+t.suggestionCrawlStep);let s;i&&(s=S.findBestMatch(e,o).ratings,s.sort((t,e)=>e.rating-t.rating),s=s.slice(0,4).filter(t=>t.target!==e),s=s.concat(r),s.sort((t,e)=>e.rating-t.rating),s=s.slice(0,3)),k+=t.suggestionCrawlStep,k<i.length?Q=setTimeout(()=>{$(e,!0,s)},0):(K(s.map(t=>t.target)),I())},K=t=>{n.suggestions=t.map(t=>({char:t,suggestion:!0}))},tt=()=>{n.suggestions=[],n.uninterruptedString="",I()},et=()=>{O=null,P=null,Y=null},at=()=>{k=0,clearTimeout(Q),Q=null},rt=()=>{if(!n.swipeActive)return;const e=n.swipePoints[n.swipePoints.length-1];if(e){if(L(e,n.mousePos)<t.swipeMinimumVectorLength)return}n.swipePoints.push(d(d({},n.mousePos),{},{t:Date.now()}))},ct=()=>{z=[],v=[],b=[],A=[],C=null,et()},ht=e=>{t.layouts[e]&&(n.selectedLanguage=e,nt(e),t.swipe&&(()=>{if(E=!1,tt(),void 0!==T[n.selectedLanguage])return H();n.swipeLoadingProgress=0;U&&U.abort(),U=new XMLHttpRequest,U.open("GET","".concat("./wordlist/").concat(n.selectedLanguage,".txt"),!0),U.responseType="text",U.onload=function(){U.readyState===U.DONE&&200===U.status&&(T[n.selectedLanguage]={},W(U.responseText),H())},U.onprogress=function(t){n.swipeLoadingProgress=t.loaded/t.total,I()},ct(),U.send(null)})())},nt=e=>{n.layout=t.layouts[e],n.currentLayout=e,n.widthUnits=s();const a=(n.widthUnits+1)*n.margin;n.buttonSize=(i.width-a)/n.widthUnits,n.uninterruptedString="",n.stateChange=!1,I()},it=()=>{i.width=512*t.resolution,i.height=i.width/t.aspect,n.margin=t.margin*t.resolution,n.buttonHeight=t.buttonHeight*t.resolution,n.currentLayout&&nt(n.currentLayout)};function ot(){}Object.assign(ot.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var a=this._listeners;void 0===a[t]&&(a[t]=[]),-1===a[t].indexOf(e)&&a[t].push(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var a=this._listeners[t];if(void 0!==a){var r=a.indexOf(e);-1!==r&&a.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var a=e.slice(0),r=0,c=a.length;r<c;r++)a[r].call(this,t)}}}});const st=new ot,ut=(e,a)=>{let r=null,c=e.char;e.char.length<=2&&!t.languages.includes(e.char.toLowerCase())&&(r=a?e.char.toUpperCase():e.char);let h=!1;e.suggestion&&(r=e.char+" ",c="suggestion",n.swipePlacedWord&&n.uninterruptedString.length&&(n.uninterruptedString+=" "),n.uninterruptedString.length&&(h=!0)),n.swipePlacedWord&&"bksp"==e.char&&(h=!0);var i=n.uninterruptedString.length;if(h){n.uninterruptedString="";for(let t=0;t<i;t++)ut({char:"bksp"})}"space"===e.char&&(r=" "),st.dispatchEvent({type:lt,key:c,char:r})},lt="keyDown";var gt=Object.freeze({__proto__:null,dispatcher:st,addEventListener:(t,e)=>{st.addEventListener(t,e)},removeEventListener:(t,e)=>{st.removeEventListener(t,e)},dispatchEvent:ut,KEYDOWN:lt});const Mt=()=>{if(!n.activeElement||!n.activeElement.extra)return;if(!n.mouseDown)return dt(n.activePopupElement),!0;const{x:t,y:e}=n.mousePos,{pos:a}=n.activeElement,{startX:r,startY:c,keyArr:h,popupWidth:i,popupHeight:o}=g(a,[...n.activeElement.extra]);let s=null,u=Number.POSITIVE_INFINITY,l=c+n.buttonHeight/2;for(let a=0;a<h.length;a++){const c=h[a];let i=r+n.buttonSize/2;for(let a=0;a<c.length;a++){const r=c[a],h=L({x:t,y:e},{x:i,y:l});h<u&&(s=r,u=h),i+=n.buttonSize}l-=n.buttonHeight}return n.activePopupElement&&n.activePopupElement===s&&n.activePopupElement.down===n.mouseDown||(wt(),n.activePopupElement=s,n.activePopupElement.hover=!0,n.activePopupElement.down=!0,n.stateChange=!0),t>r&&t<r+i&&e>c-n.buttonHeight*(h.length-1)&&e<c-n.buttonHeight*(h.length-1)+o||t>a.x&&t<a.x+n.buttonSize&&e>a.y-n.buttonHeight&&e<a.y+n.buttonHeight},Lt=()=>{n.activeElement&&(n.activeElement.hover=!1,n.activeElement.down=!1,n.activeElement=null)},jt=()=>{n.activeSuggestionElement&&(n.activeSuggestionElement.hover=!1,n.activeSuggestionElement.down=!1,n.activeSuggestionElement=null)},wt=()=>{n.activePopupElement&&(n.activePopupElement.hover=!1,n.activePopupElement.down=!1,n.activePopupElement=null)},pt=()=>{n.holdTimeout&&clearTimeout(n.holdTimeout),n.bkspInterval&&clearInterval(n.bkspInterval),n.keyPopup=!1},Nt=()=>{pt(),n.holdTimeout=setTimeout(()=>{n.swipeActive||(n.keyPopup=!0,wt(),Mt(),I(),n.activeElement&&"bksp"===n.activeElement.char&&(n.bkspInterval=setInterval(()=>{if(n.activeElement&&(ut(n.activeElement),t.swipe)){const t=n.uninterruptedString;n.uninterruptedString=n.uninterruptedString.substr(0,n.uninterruptedString.length-1),t!==n.uninterruptedString&&(B(),I())}},t.bkspIntervalTime)))},t.holdPopupTime)},dt=e=>{if(wt(),jt(),Lt(),pt(),!n.swipeActive){switch(ut(e,n.shiftDown),e.suggestion&&tt(),e.char){case"abc":nt(n.selectedLanguage);break;case"!?#":case"?123":nt("num");break;case"=\\<":nt("sym");break;case"1234":nt("nump");break;case"shift":!n.permaShift&&Date.now()-n.shiftDownTime<t.shiftDoubleTapTimeout?(n.shiftDown=!0,n.permaShift=!0,n.shiftDownTime=0):(n.shiftDown=!n.shiftDown,n.permaShift=!1,n.shiftDownTime=Date.now()),n.stateChange=!0;break;case"lang":for(let e=0;e<t.languages.length;e++)if(t.languages[e]===n.selectedLanguage){let a=e+1;t.languages[a]||(a=0),ht(t.languages[a]);break}break;default:t.languages.includes(e.char.toLowerCase())?ht(e.char.toLowerCase()):(n.shiftDown&&!n.permaShift&&(n.shiftDown=!1),t.swipe&&(["space","enter"].includes(e.char)&&tt(),"bksp"===e.char?n.uninterruptedString=n.uninterruptedString.substr(0,n.uninterruptedString.length-1):n.swipePlacedWord&&(n.uninterruptedString=""),n.currentLayout===n.selectedLanguage&&e.char.length<=2&&(n.uninterruptedString+=e.char)),n.stateChange=!0)}return n.swipePlacedWord=!1,e}},St=()=>i,yt=()=>n.activeElement,xt=ht,ft=nt,Dt=(e,a,r)=>{t.resolution=r,n.buttonHeight=t.buttonHeight*t.resolution,n.margin=t.margin*t.resolution;const c=(n.layout.length*n.buttonHeight+(n.layout.length+1)*n.margin+(2*n.buttonHeight+3*n.margin))/t.resolution;a=Math.max(a,c),i.width=e*t.resolution,i.height=a*t.resolution,i.style.width="".concat(e,"px"),i.style.height="".concat(a,"px"),n.currentLayout&&nt(n.currentLayout)},mt=it,It=(t,e,a)=>{if(n.mouseDown=t,void 0!==e?Et(e,a):Et(n.mousePos.x,n.mousePos.y),!n.mouseDown&&n.swipeActive){if(n.suggestions.length>0){const t=n.suggestions.shift();ut(t,n.shiftDown),n.uninterruptedString=t.char,n.swipePlacedWord=!0}n.swipeActive=!1}},Tt=(t,e)=>{Et(i.width*t,i.height*e)},Et=(e,a)=>{let r;n.mousePos.x=e,n.mousePos.y=a,n.keyPopup&&(r=Mt()),!r&&t.swipe&&(r=(()=>{const{x:t,y:e}=n.mousePos,a=o()-n.buttonHeight-3*n.margin,{suggestions:r,suggestionSize:c,totalWidth:h}=M();let s=i.width/2-h/2;for(let h=0;h<r.length;h++){const i=r[h];if(t>s&&t<s+c&&e>a&&e<a+n.buttonHeight){if(!n.activeSuggestionElement||n.activeSuggestionElement!==i||n.activeSuggestionElement.down!==n.mouseDown){if(n.activeSuggestionElement===i&&n.activeSuggestionElement.down&&!n.mouseDown)return dt(n.activeSuggestionElement);jt(),n.activeSuggestionElement=i,n.activeSuggestionElement.hover=!0,n.activeSuggestionElement.down=n.mouseDown,n.stateChange=!0}return n.activeSuggestionElement}s+=c+n.margin}})()),r||(r=(()=>{const{x:t,y:e}=n.mousePos,a=o(),r=Math.floor((e-a)/(n.buttonHeight+n.margin)),c=n.layout[r];if(!c)return;let h=n.margin+u()+l(r);for(let e=0;e<c.length;e++){const a=c[e];let r=a.w?a.w:1,i=n.buttonSize*r;i+=(r-1)*n.margin;let o=t>h;if(h+=i+n.margin,o&&t<h-n.margin){if(!n.activeElement||n.activeElement!==a||n.activeElement.down!==n.mouseDown){if(n.activeElement===a&&n.activeElement.down&&!n.mouseDown)return dt(n.activeElement);Lt(),n.activeElement=a,n.activeElement.hover=!0,n.activeElement.down=n.mouseDown,n.activeElement.down?Nt():pt(),n.stateChange=!0}return n.activeElement}}})()),t.swipe&&n.mouseDown&&!n.keyPopup&&(()=>{if(!E)return;C||(C=d({},n.mousePos));L(n.mousePos,C)>t.swipeMinimumDistance*t.resolution&&(n.swipeActive=!0),rt(),n.activeElement&&V(),_()})(),r||!n.activeElement&&!n.activeSuggestionElement||(Lt(),jt(),n.stateChange=!0),t.swipe&&!n.mouseDown&&n.previousMouseState&&(n.keyPopup||B(),n.stateChange=!0),n.previousMouseState=n.mouseDown,n.stateChange&&I()},zt=()=>{const e=(e,a)=>{const r=i.getBoundingClientRect();return e-=r.x,a-=r.y,[e*t.resolution,a*t.resolution]};document.addEventListener("mousemove",t=>{Et(...e(t.clientX,t.clientY))}),i.addEventListener("mousedown",t=>{It(!0,...e(t.clientX,t.clientY)),t.preventDefault()}),document.addEventListener("mouseup",t=>{It(!1)}),document.addEventListener("touchmove",t=>{const a=t.touches[0];Et(...e(a.clientX,a.clientY)),t.preventDefault()},{passive:!1}),i.addEventListener("touchstart",t=>{const a=t.touches[0];It(!0,...e(a.clientX,a.clientY)),t.preventDefault()},{passive:!1}),document.addEventListener("touchend",t=>{It(!1)},{passive:!1})},vt=t=>{n.textureDirty=t},bt=()=>n.textureDirty,At=tt,Ct=e=>{Object.assign(t,e),t.languages.forEach(e=>{const a=t.layouts[e][3][2];a.extra=[],t.languages.forEach(t=>{a.extra.push({char:t.toUpperCase()})})}),it(),ht(t.language),c().then(()=>{I()})};export{zt as addListeners,gt as events,yt as getActiveElement,St as getCanvas,bt as getTextureDirty,Ct as init,At as resetSuggestionInput,xt as selectLanguage,ft as setLayout,It as setMouseDown,Et as setMousePos,Tt as setMousePosFromUV,mt as setScreenSizeFromAspectRatio,Dt as setScreenSizeInPixels,vt as setTextureDirty};
